# frozen_string_literal: true

class AddResolvedAtDismissedAtFieldsToVulnerability < Elastic::Migration
  include ::Search::Elastic::MigrationUpdateMappingsHelper

  DOCUMENT_TYPE = Vulnerability

  private

  def index_name
    ::Search::Elastic::Types::Vulnerability.index_name
  end

  def new_mappings
    {
      resolved_at: {
        type: 'date'
      },
      dismissed_at: {
        type: 'date'
      }
    }
  end
end

AddResolvedAtDismissedAtFieldsToVulnerability.prepend ::Search::Elastic::MigrationObsolete
