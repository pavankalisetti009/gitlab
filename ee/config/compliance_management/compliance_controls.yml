# Compliance Framework Control Registry
#
# IMPORTANT: The order and values of controls should not be changed once deployed.
# New controls should be added at the end to preserve enum values.
#
# Supported control types:
# - boolean: {=, !=}
# - numeric: {=, !=, >, <, >=, <=}
# - enum: {=, !=}

---
special_controls:
  external_control: 10000
controls:
  scanner_sast_running:
    name: SAST Running
    type: boolean
    compliant_value: true
    compliant_operator: '='
    field_method: scanner_sast_running?
    enum_value: 0
  minimum_approvals_required_2:
    name: At least two approvals
    type: numeric
    field_id: minimum_approvals_required
    compliant_value: 2
    compliant_operator: '>='
    field_method: minimum_approvals_required
    enum_value: 1
  merge_request_prevent_author_approval:
    name: Author approved merge request
    type: boolean
    compliant_value: true
    compliant_operator: '='
    field_method: merge_request_prevent_author_approval?
    enum_value: 2
  merge_request_prevent_committers_approval:
    name: Committers approved merge request
    type: boolean
    compliant_value: true
    compliant_operator: '='
    field_method: merge_requests_disable_committers_approval?
    enum_value: 3
  project_visibility_not_internal:
    name: Internal visibility is forbidden
    type: boolean
    compliant_value: true
    compliant_operator: "="
    field_method: project_visibility_not_internal?
    enum_value: 4
  default_branch_protected:
    name: Default branch protected
    type: boolean
    compliant_value: true
    compliant_operator: '='
    field_method: default_branch_protected?
    enum_value: 5
  auth_sso_enabled:
    name: Auth SSO Enabled
    type: boolean
    compliant_value: true
    compliant_operator: '='
    field_method: auth_sso_enabled?
    enum_value: 6
  scanner_secret_detection_running:
    name: Secret Detection Running
    type: boolean
    compliant_value: true
    compliant_operator: '='
    field_method: scanner_secret_detection_running?
    enum_value: 7
  scanner_dep_scanning_running:
    name: Dependency Scanning Running
    type: boolean
    compliant_value: true
    compliant_operator: '='
    field_method: scanner_dep_scanning_running?
    enum_value: 8
  scanner_container_scanning_running:
    name: Container Scanning Running
    type: boolean
    compliant_value: true
    compliant_operator: '='
    field_method: scanner_container_scanning_running?
    enum_value: 9
  scanner_license_compliance_running:
    name: License Compliance Running
    type: boolean
    compliant_value: true
    compliant_operator: '='
    field_method: scanner_license_compliance_running?
    enum_value: 10
  scanner_dast_running:
    name: DAST Running
    type: boolean
    compliant_value: true
    compliant_operator: '='
    field_method: scanner_dast_running?
    enum_value: 11
  scanner_api_security_running:
    name: API Security Running
    type: boolean
    compliant_value: true
    compliant_operator: '='
    field_method: scanner_api_security_running?
    enum_value: 12
  scanner_fuzz_testing_running:
    name: Fuzz Testing Running
    type: boolean
    compliant_value: true
    compliant_operator: '='
    field_method: scanner_fuzz_testing_running?
    enum_value: 13
  scanner_code_quality_running:
    name: Code Quality Running
    type: boolean
    compliant_value: true
    compliant_operator: '='
    field_method: scanner_code_quality_running?
    enum_value: 14
  scanner_iac_running:
    name: IaC Scanning Running
    type: boolean
    compliant_value: true
    compliant_operator: '='
    field_method: scanner_iac_running?
    enum_value: 15
  code_changes_requires_code_owners:
    name: Code Changes Requires Code Owners
    type: boolean
    compliant_value: true
    compliant_operator: '='
    field_method: code_changes_requires_code_owners?
    enum_value: 16
  reset_approvals_on_push:
    name: Reset Approvals on Push
    type: boolean
    compliant_value: true
    compliant_operator: '='
    field_method: reset_approvals_on_push?
    enum_value: 17
  status_checks_required:
    name: Status Checks Required
    type: boolean
    compliant_value: true
    compliant_operator: '='
    field_method: status_checks_required?
    enum_value: 18
  require_branch_up_to_date:
    name: Require Branch Up to Date
    type: boolean
    compliant_value: true
    compliant_operator: '='
    field_method: require_branch_up_to_date?
    enum_value: 19
  resolve_discussions_required:
    name: Resolve Discussions Required
    type: boolean
    compliant_value: true
    compliant_operator: '='
    field_method: resolve_discussions_required?
    enum_value: 20
  require_linear_history:
    name: Require Linear History
    type: boolean
    compliant_value: true
    compliant_operator: '='
    field_method: require_linear_history?
    enum_value: 21
  restrict_push_merge_access:
    name: Restrict Push/Merge Access
    type: boolean
    compliant_value: true
    compliant_operator: '='
    field_method: restrict_push_merge_access?
    enum_value: 22
  force_push_disabled:
    name: Force Push Disabled
    type: boolean
    compliant_value: true
    compliant_operator: '='
    field_method: force_push_disabled?
    enum_value: 23
  terraform_enabled:
    name: Terraform Enabled
    type: boolean
    compliant_value: true
    compliant_operator: '='
    field_method: terraform_enabled?
    enum_value: 24

  version_control_enabled:
    name: 'Version Control Enabled'
    type: boolean
    compliant_value: true
    compliant_operator: '='
    field_method: version_control_enabled?
    enum_value: 25

  issue_tracking_enabled:
    name: 'Issue Tracking Enabled'
    type: boolean
    compliant_value: true
    compliant_operator: '='
    field_method: issue_tracking_enabled?
    enum_value: 26

  stale_branch_cleanup_enabled:
    name: 'Stale Branch Cleanup Enabled'
    type: boolean
    compliant_value: true
    compliant_operator: '='
    field_method: stale_branch_cleanup_enabled?
    enum_value: 27

  branch_deletion_disabled:
    name: 'Branch Deletion Disabled'
    type: boolean
    compliant_value: true
    compliant_operator: '='
    field_method: branch_deletion_disabled?
    enum_value: 28

  review_and_archive_stale_repos:
    name: 'Review and Archive Stale Repositories'
    type: boolean
    compliant_value: true
    compliant_operator: '='
    field_method: review_and_archive_stale_repos?
    enum_value: 29

  review_and_remove_inactive_users:
    name: 'Review and Remove Inactive Users'
    type: boolean
    compliant_value: true
    compliant_operator: '='
    field_method: review_and_remove_inactive_users?
    enum_value: 30

  minimum_number_of_admins:
    name: 'Minimum Number of Admins'
    type: boolean
    compliant_value: true
    compliant_operator: '='
    field_method: minimum_number_of_admins?
    enum_value: 31

  require_mfa_for_contributors:
    name: 'Require MFA for Contributors'
    type: boolean
    compliant_value: true
    compliant_operator: '='
    field_method: require_mfa_for_contributors?
    enum_value: 32

  require_mfa_at_org_level:
    name: 'Require MFA at Org Level'
    type: boolean
    compliant_value: true
    compliant_operator: '='
    field_method: require_mfa_at_org_level?
    enum_value: 33

  ensure_2_admins_per_repo:
    name: 'Ensure 2 Admins per Repository'
    type: boolean
    compliant_value: true
    compliant_operator: '='
    field_method: ensure_2_admins_per_repo?
    enum_value: 34

  strict_permissions_for_repo:
    name: 'Strict Permission for Repository'
    type: boolean
    compliant_value: true
    compliant_operator: '='
    field_method: strict_permissions_for_repo?
    enum_value: 35

  secure_webhooks:
    name: 'Secure Webhooks'
    type: boolean
    compliant_value: true
    compliant_operator: '='
    field_method: secure_webhooks?
    enum_value: 36

  restricted_build_access:
    name: 'Restricted Build Access'
    type: boolean
    compliant_value: true
    compliant_operator: '='
    field_method: restricted_build_access?
    enum_value: 37

  gitlab_license_level_ultimate:
    name: Gitlab License Level Ultimate
    type: boolean
    compliant_value: true
    compliant_operator: '='
    field_method: gitlab_license_level_ultimate?
    enum_value: 38

  status_page_configured:
    name: Status Page Configured
    type: boolean
    compliant_value: true
    compliant_operator: '='
    field_method: status_page_configured?
    enum_value: 39

  has_valid_ci_config:
    name: Has Valid Ci Config
    type: boolean
    compliant_value: true
    compliant_operator: '='
    field_method: has_valid_ci_config?
    enum_value: 40

  error_tracking_enabled:
    name: Error Tracking Enabled
    type: boolean
    compliant_value: true
    compliant_operator: '='
    field_method: error_tracking_enabled?
    enum_value: 41

  default_branch_users_can_push:
    name: Default Branch Users Can Push
    type: boolean
    compliant_value: true
    compliant_operator: '='
    field_method: default_branch_users_can_push?
    enum_value: 42

  default_branch_protected_from_direct_push:
    name: Default Branch Protected From Direct Push
    type: boolean
    compliant_value: true
    compliant_operator: '='
    field_method: default_branch_protected_from_direct_push?
    enum_value: 43
  push_protection_enabled:
    name: Push Protection Enabled
    type: boolean
    compliant_value: true
    compliant_operator: "="
    field_method: push_protection_enabled?
    enum_value: 44
  project_marked_for_deletion:
    name: Project Marked For Deletion
    type: boolean
    compliant_value: false
    compliant_operator: "="
    field_method: project_marked_for_deletion?
    enum_value: 45
  project_archived:
    name: Project Archived
    type: boolean
    compliant_value: false
    compliant_operator: "="
    field_method: project_archived?
    enum_value: 46
  default_branch_users_can_merge:
    name: Default Branch Users Can Merge
    type: boolean
    compliant_value: true
    compliant_operator: "="
    field_method: default_branch_users_can_merge?
    enum_value: 47
  merge_request_commit_reset_approvals:
    name: Merge Request Commit Reset Approvals
    type: boolean
    compliant_value: true
    compliant_operator: "="
    field_method: merge_request_commit_reset_approvals?
    enum_value: 48
  project_visibility_not_public:
    name: Project Visibility Not Public
    type: boolean
    compliant_value: true
    compliant_operator: "="
    field_method: project_visibility_not_public?
    enum_value: 49
  package_hunter_no_findings_untriaged:
    name: Package Hunter No Findings Untriaged
    type: boolean
    compliant_value: false
    compliant_operator: "="
    field_method: package_hunter_no_findings_untriaged?
    enum_value: 50
  project_pipelines_not_public:
    name: Project Pipelines Not Public
    type: boolean
    compliant_value: true
    compliant_operator: "="
    field_method: project_pipelines_not_public?
    enum_value: 51
  vulnerabilities_slo_days_over_threshold:
    name: Vulnerabilities SLO Days Over Threshold
    type: boolean
    compliant_value: false
    compliant_operator: "="
    field_method: vulnerabilities_slo_days_over_threshold?
    enum_value: 52
  merge_requests_approval_rules_prevent_editing:
    name: Merge Requests Approval Rules Prevent Editing
    type: boolean
    compliant_value: true
    compliant_operator: "="
    field_method: merge_requests_approval_rules_prevent_editing?
    enum_value: 53
  project_user_defined_variables_restricted_to_maintainers:
    name: Project User Defined Variables Restricted To Maintainers
    type: boolean
    compliant_value: true
    compliant_operator: "="
    field_method: project_user_defined_variables_restricted_to_maintainers?
    enum_value: 54
  merge_requests_require_code_owner_approval:
    name: Merge Requests Require Code Owner Approval
    type: boolean
    compliant_value: true
    compliant_operator: "="
    field_method: merge_requests_require_code_owner_approval?
    enum_value: 55
  cicd_job_token_scope_enabled:
    name: CICD Job Token Scope Enabled
    type: boolean
    compliant_value: true
    compliant_operator: "="
    field_method: cicd_job_token_scope_enabled?
    enum_value: 56
