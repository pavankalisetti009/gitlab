# frozen_string_literal: true

require 'spec_helper'

RSpec.describe Security::VulnerabilityScanning::ProcessSbomScanThrottledWorker, feature_category: :software_composition_analysis do
  describe 'worker configuration' do
    it 'inherits from ProcessSbomScanWorker' do
      expect(described_class.superclass).to eq(Security::VulnerabilityScanning::ProcessSbomScanWorker)
    end

    it 'has low urgency' do
      expect(described_class.get_urgency).to eq(:low)
    end

    it 'has the correct concurrency limit' do
      expect(described_class.get_concurrency_limit).to eq(35)
    end

    it 'includes ApplicationWorker' do
      expect(described_class.included_modules).to include(ApplicationWorker)
    end
  end
end
