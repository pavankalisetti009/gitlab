# frozen_string_literal: true

require 'spec_helper'

RSpec.describe GitlabSchema.types['VulnerabilityDetailRow'], feature_category: :vulnerability_management do
  it { expect(described_class).to have_graphql_fields(:name, :description, :fieldName, :row) }

  describe '.authorization_scopes' do
    it 'includes :ai_workflows' do
      expect(described_class.authorization_scopes).to include(:ai_workflows)
    end
  end

  describe 'field scopes' do
    it 'includes the correct scopes for the row field' do
      expect(described_class.fields['row'].instance_variable_get(:@scopes)).to include(:api, :read_api, :ai_workflows)
    end
  end
end
