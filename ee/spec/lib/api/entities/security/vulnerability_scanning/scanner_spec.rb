# frozen_string_literal: true

require 'spec_helper'

RSpec.describe API::Entities::Security::VulnerabilityScanning::Scanner, feature_category: :software_composition_analysis do
  let(:scanner) { Gitlab::VulnerabilityScanning::SecurityScanner.fabricate }

  let(:expected_formatted_json) do
    {
      id: "gitlab-sbom-vulnerability-scanner",
      name: "GitLab SBoM Vulnerability Scanner",
      url: "https://docs.gitlab.com/user/application_security/dependency_scanning/dependency_scanning_sbom/",
      vendor: {
        name: "GitLab"
      },
      version: Gitlab.version_info.to_s
    }
  end

  subject { described_class.new(scanner).as_json }

  it 'formats the scanner as expected' do
    is_expected.to eq(expected_formatted_json)
  end
end
