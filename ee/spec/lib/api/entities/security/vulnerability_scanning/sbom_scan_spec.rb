# frozen_string_literal: true

require 'spec_helper'

RSpec.describe API::Entities::Security::VulnerabilityScanning::SbomScan, feature_category: :software_composition_analysis do
  let(:sbom_scan) { build_stubbed(:sbom_scan) }

  subject(:output) { described_class.new(sbom_scan).as_json }

  it 'format the sbom_scan as expected', :aggregate_failures do
    expect(output[:id]).to eq(sbom_scan.id)
    expect(output[:download_url]).to end_with("/api/v4/jobs/#{sbom_scan.build_id}/sbom_scans/#{sbom_scan.id}")
  end
end
