# frozen_string_literal: true

require 'spec_helper'

RSpec.describe ::Search::Elastic::VulnerabilityAggregations, feature_category: :vulnerability_management do
  let(:query_hash) { {} }

  describe '#by_severity_counts' do
    it 'adds size and aggs to query_hash' do
      expect(described_class.by_severity_counts(query_hash: query_hash)).to eq({
        size: 0,
        aggs: {
          severity_counts: {
            terms: {
              field: "severity"
            }
          }
        }
      })
    end
  end
end
