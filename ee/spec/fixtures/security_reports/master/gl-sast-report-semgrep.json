{
  "version": "15.2.2",
  "vulnerabilities": [
    {
      "id": "ae818ae61ec467b4d787a26b99ab0378d7b3c60fae72804bc3a6b5b814421ac8",
      "category": "sast",
      "name": "Authentication bypass by primary weakness",
      "description": "A key stored in the Keychain is using a weak accessibility value. \n\nkSecAttrAccessibleAlways allows access to the keychain item at all \ntimes, even when the device is locked. Storing sensitive data with \nthis accessibility option means that the data is accessible to anyone \nwho gains physical access to the device, regardless of whether it's \nlocked or not. This increases the risk of unauthorized access to \nsensitive information. kSecAttrAccessibleAfterFirstUnlock allows access\nto the keychain item only after the device has been unlocked once after\na reboot. While this provides some level of protection, the data becomes\naccessible as soon as the device is unlocked for the first time after a\nreboot. If sensitive data is stored with this accessibility option, it \ncould still be accessed by an attacker who gains physical access to the\ndevice before it's unlocked for the first time after a reboot.\n\nTo mitigate these security risks, it's important to use the appropriate \naccessibility option based on the sensitivity of the data being stored. \nFor sensitive data that should only be accessible when the device is \nunlocked, the kSecAttrAccessibleWhenUnlocked or \nkSecAttrAccessibleWhenUnlockedThisDeviceOnly \noptions should be used.\n\nHere's an example code that fixes the problem by using the \nkSecAttrAccessibleWhenUnlocked option:\n```\nimport Foundation\nimport Security\n\n// Define the data to be stored in the keychain\nlet secretData = \"superSecretData\".data(using: .utf8)!\n\n// Create query dictionary to specify the keychain item\nlet query: [String: Any] = [\n           kSecClass as String: kSecClassGenericPassword,\n           kSecAttrService as String: \"com.example.myApp\",\n           kSecAttrAccount as String: \"userPassword\",\n           kSecValueData as String: secretData,\n           kSecAttrAccessible as String: kSecAttrAccessibleWhenUnlocked\n]\n\n// Add the keychain item\nlet status = SecItemAdd(query as CFDictionary, nil)\nif status == errSecSuccess {\n  print(\"Secret data successfully stored in keychain.\")\n} else {\n  print(\"Error storing secret data in keychain: \\(status)\")\n}\n```\n",
      "cve": "semgrep_id:mobsf.swift-other-rule-ios_keychain_weak_accessibility_value:20:20",
      "severity": "Medium",
      "scanner": {
        "id": "semgrep",
        "name": "Semgrep"
      },
      "location": {
        "file": "helloAppCopy.swift",
        "start_line": 20
      },
      "identifiers": [
        {
          "type": "semgrep_id",
          "name": "mobsf.swift-other-rule-ios_keychain_weak_accessibility_value",
          "value": "mobsf.swift-other-rule-ios_keychain_weak_accessibility_value"
        },
        {
          "type": "cwe",
          "name": "CWE-305",
          "value": "305",
          "url": "https://cwe.mitre.org/data/definitions/305.html"
        },
        {
          "type": "owasp",
          "name": "A07:2021 - Identification and Authentication Failures",
          "value": "A07:2021"
        },
        {
          "type": "owasp",
          "name": "A2:2017 - Broken Authentication",
          "value": "A2:2017"
        },
        {
          "type": "mobsf_rule_type",
          "name": "mobsf ID swift-other-rule-ios_keychain_weak_accessibility_value",
          "value": "swift-other-rule-ios_keychain_weak_accessibility_value"
        }
      ]
    }
  ],
  "scan": {
    "analyzer": {
      "id": "semgrep",
      "name": "Semgrep",
      "url": "https://gitlab.com/gitlab-org/security-products/analyzers/semgrep",
      "vendor": {
        "name": "GitLab"
      },
      "version": "6.7.1"
    },
    "scanner": {
      "id": "semgrep",
      "name": "Semgrep",
      "url": "https://github.com/returntocorp/semgrep",
      "vendor": {
        "name": "GitLab"
      },
      "version": "6.7.1"
    },
    "type": "sast",
    "start_time": "2025-10-07T04:04:31",
    "end_time": "2025-10-07T04:04:41",
    "status": "success"
  }
}
