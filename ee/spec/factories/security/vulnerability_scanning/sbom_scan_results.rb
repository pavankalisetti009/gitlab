# frozen_string_literal: true

FactoryBot.define do
  factory :sbom_scan_result, class: 'Security::VulnerabilityScanning::SbomScanResult' do
    project

    trait :with_result_file do
      result_file do
        fixture_file_upload('ee/spec/fixtures/security/vulnerability_scanning/sbom_scans/sbom_scan_result.json',
          'application/json')
      end

      # Save file after record is created to have the id value in final file path
      after :create, &:store_result_file!
    end
  end
end
