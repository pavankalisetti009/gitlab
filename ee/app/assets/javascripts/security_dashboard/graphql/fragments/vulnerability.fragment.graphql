#import "./vulnerability_location.fragment.graphql"
#import "./severity_override.fragment.graphql"

fragment VulnerabilityFragment on Vulnerability {
  id
  title
  state
  severity
  detectedAt
  dismissalReason
  vulnerabilityPath
  resolvedOnDefaultBranch
  userNotesCount
  aiResolutionAvailable
  aiResolutionEnabled
  falsePositive @include(if: $vetEnabled)
  severityOverrides(first: 1) @include(if: $includeSeverityOverrides) {
    nodes {
      ...SeverityOverrideFragment
    }
  }
  hasRemediations
  issueLinks {
    nodes {
      id
      issue {
        id
        iid
        webUrl
        webPath
        title
        state
      }
    }
  }
  mergeRequest {
    id
    webUrl
    state
    iid
    author {
      id
      human
    }
  }
  identifiers {
    externalType
    name
  }
  location {
    ...VulnerabilityLocation
  }
  project {
    id
    nameWithNamespace
  }
  findingTokenStatus {
    id
    status
  }
  cvss {
    overallScore
    version
  }
  cveEnrichment {
    epssScore
    isKnownExploit
  }
  reportType
  scanner {
    id
    vendor
    name
  }
  archivalInformation {
    aboutToBeArchived
    expectedToBeArchivedOn
  }
  policyViolations @gl_introduced(version: "18.6.0")
  reachability
  aiWorkflows {
    nodes {
      workflowName
      workflow {
        id
        humanStatus
        status
        createdAt
      }
    }
  }
  latestFlag @include(if: $includeLatestFlag) {
    id
    description
    confidenceScore
  }
}
