import { s__ } from '~/locale';

export const NO_LONGER_DETECTED_RULE_TYPE = 'no_longer_detected';
export const VULNERABILITY_DETECTED_TYPE = 'detected';

export const DEFAULT_VULNERABILITY_MANAGEMENT_POLICY = `vulnerability_management_policy:
  - name: ''
    description: ''
    enabled: true
    rules:
      - type: ${NO_LONGER_DETECTED_RULE_TYPE}
        scanners: []
        severity_levels: []
    actions:
      - type: auto_resolve
`;

export const AUTO_RESOLVE = 'auto_resolve';
export const AUTO_DISMISS = 'auto_dismiss';

export const ACTION_TYPES = {
  [AUTO_RESOLVE]: s__('SecurityOrchestration|Auto-Resolve'),
  [AUTO_DISMISS]: s__('SecurityOrchestration|Auto-Dismiss'),
};

export const ACTION_TYPES_SELECTOR_FORMAT = Object.entries(ACTION_TYPES).map(([value, text]) => ({
  value,
  text,
}));

export const ACTION_HUMANIZED_TEMPLATE = s__(
  'SecurityOrchestration|Then automatically set the status of these vulnerabilities to %{type}.',
);

export const ACTION_DISMISS_HUMANIZED_TEMPLATE = s__(
  'SecurityOrchestration|Then automatically %{boldStart}dismiss%{boldEnd} these vulnerabilities with the %{reason} reason.',
);

export const RULE_HUMANIZED_TEMPLATE = s__(
  'SecurityOrchestration|If %{scanners} of the default branch finds %{severity_level} vulnerabilities are no longer detected.',
);

export const RULE_HUMANIZED_TEMPLATE_VULNERABILITY_FOUND = s__(
  'SecurityOrchestration|If vulnerabilities are automatically dismissed when found under following criteria:',
);

export const ACCEPTABLE_RISK = 'acceptable_risk';
export const FALSE_POSITIVE = 'false_positive';
export const MITIGATING_CONTROL = 'mitigating_control';
export const USED_IN_TESTS = 'used_in_tests';
export const NOT_APPLICABLE = 'not_applicable';

export const DISMISS_REASONS = {
  [ACCEPTABLE_RISK]: s__('SecurityOrchestration|Acceptable Risk'),
  [FALSE_POSITIVE]: s__('SecurityOrchestration|False positive'),
  [MITIGATING_CONTROL]: s__('SecurityOrchestration|Mitigating Control'),
  [USED_IN_TESTS]: s__('SecurityOrchestration|Used in tests'),
  [NOT_APPLICABLE]: s__('SecurityOrchestration|Not Applicable'),
};

export const FILE_PATH = 'file_path';
export const DIRECTORY = 'directory';
export const IDENTIFIER = 'identifier';

export const CRITERIA_TYPES = {
  [DIRECTORY]: s__('SecurityOrchestration|directory'),
  [FILE_PATH]: s__('SecurityOrchestration|file path'),
  [IDENTIFIER]: s__('SecurityOrchestration|identifier'),
};
