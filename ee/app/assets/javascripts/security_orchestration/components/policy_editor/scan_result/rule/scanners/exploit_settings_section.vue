<script>
import { s__ } from '~/locale';
import SectionLayout from 'ee/security_orchestration/components/policy_editor/section_layout.vue';
import KevFilter from 'ee/security_orchestration/components/policy_editor/scan_result/rule/scan_filters/kev_filter.vue';
import EpssFilter from 'ee/security_orchestration/components/policy_editor/scan_result/rule/scan_filters/epss_filter.vue';

export default {
  i18n: {
    exploitTitle: s__('SecurityOrchestration|Exploit settings'),
  },
  name: 'ExploitSettingsSection',
  components: {
    SectionLayout,
    KevFilter,
    EpssFilter,
  },
  props: {
    kevFilterValue: {
      type: Boolean,
      required: false,
      default: undefined,
    },
    epssOperator: {
      type: String,
      required: false,
      default: undefined,
    },
    epssValue: {
      type: Number,
      required: false,
      default: 0,
    },
  },
  emits: ['kev-change', 'epss-change'],
};
</script>

<template>
  <section-layout
    class="gl-mt-4 gl-bg-white gl-px-0 gl-pb-0 gl-pr-0"
    content-classes="!gl-gap-0"
    :show-remove-button="false"
  >
    <template #content>
      <h5 class="gl-m-0 gl-mb-2 gl-px-5">{{ $options.i18n.exploitTitle }}</h5>

      <kev-filter :selected="kevFilterValue" @select="$emit('kev-change', $event)" />

      <epss-filter
        :selected-operator="epssOperator"
        :selected-value="epssValue"
        @select="$emit('epss-change', $event)"
      />
    </template>
  </section-layout>
</template>
