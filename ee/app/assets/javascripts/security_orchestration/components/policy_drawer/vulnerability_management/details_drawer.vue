<script>
import { fromYaml } from 'ee/security_orchestration/components/policy_editor/vulnerability_management/utils';
import { VULNERABILITY_MANAGEMENT_POLICY_TYPE_HEADER } from 'ee/security_orchestration/components/constants';
import DrawerLayout from '../drawer_layout.vue';

export default {
  i18n: {
    vulnerabilityManagement: VULNERABILITY_MANAGEMENT_POLICY_TYPE_HEADER,
  },
  components: {
    DrawerLayout,
  },
  props: {
    policy: {
      type: Object,
      required: true,
    },
  },
  computed: {
    policyScope() {
      return this.policy?.policyScope;
    },
    parsedYaml() {
      return fromYaml({ manifest: this.policy.yaml });
    },
    description() {
      return this.parsedYaml?.description || '';
    },
  },
};
</script>

<template>
  <drawer-layout
    key="vulnerability_management_policy"
    :description="description"
    :policy="policy"
    :policy-scope="policyScope"
    :type="$options.i18n.vulnerabilityManagement"
  />
</template>
