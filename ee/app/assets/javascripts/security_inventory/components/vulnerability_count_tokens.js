import { s__ } from '~/locale';
import { OPERATORS_LESS_THAN_EQUAL_TO_GREATER_THAN } from '~/vue_shared/components/filtered_search_bar/constants';
import { CRITICAL, HIGH, MEDIUM, LOW, INFO, UNKNOWN } from 'ee/vulnerabilities/constants';
import BaseToken from '~/vue_shared/components/filtered_search_bar/tokens/base_token.vue';
import { SEVERITY_FILTER_LABELS, SEVERITY_SEGMENT_LABELS } from '../constants';

const showWhenAnyItemMatches = ({ query, title, defaultMatcher }) =>
  [
    title,
    SEVERITY_FILTER_LABELS[CRITICAL],
    SEVERITY_FILTER_LABELS[HIGH],
    SEVERITY_FILTER_LABELS[MEDIUM],
    SEVERITY_FILTER_LABELS[LOW],
    SEVERITY_FILTER_LABELS[INFO],
    SEVERITY_FILTER_LABELS[UNKNOWN],
  ].some((keyword) => defaultMatcher(keyword, query));

export const vulnerabilityCountTokens = [
  {
    type: 'gl-filtered-search-suggestion-group-vulnerability-count',
    title: s__('SecurityInventory|Vulnerability count'),
    match: showWhenAnyItemMatches,
  },
  {
    type: CRITICAL,
    title: SEVERITY_FILTER_LABELS[CRITICAL],
    segmentTitle: SEVERITY_SEGMENT_LABELS[CRITICAL],
    token: BaseToken,
    unique: true,
    operators: OPERATORS_LESS_THAN_EQUAL_TO_GREATER_THAN,
  },
  {
    type: HIGH,
    title: SEVERITY_FILTER_LABELS[HIGH],
    segmentTitle: SEVERITY_SEGMENT_LABELS[HIGH],
    token: BaseToken,
    unique: true,
    operators: OPERATORS_LESS_THAN_EQUAL_TO_GREATER_THAN,
  },
  {
    type: MEDIUM,
    title: SEVERITY_FILTER_LABELS[MEDIUM],
    segmentTitle: SEVERITY_SEGMENT_LABELS[MEDIUM],
    token: BaseToken,
    unique: true,
    operators: OPERATORS_LESS_THAN_EQUAL_TO_GREATER_THAN,
  },
  {
    type: LOW,
    title: SEVERITY_FILTER_LABELS[LOW],
    segmentTitle: SEVERITY_SEGMENT_LABELS[LOW],
    token: BaseToken,
    unique: true,
    operators: OPERATORS_LESS_THAN_EQUAL_TO_GREATER_THAN,
  },
  {
    type: INFO,
    title: SEVERITY_FILTER_LABELS[INFO],
    segmentTitle: SEVERITY_SEGMENT_LABELS[INFO],
    token: BaseToken,
    unique: true,
    operators: OPERATORS_LESS_THAN_EQUAL_TO_GREATER_THAN,
  },
  {
    type: UNKNOWN,
    title: SEVERITY_FILTER_LABELS[UNKNOWN],
    segmentTitle: SEVERITY_SEGMENT_LABELS[UNKNOWN],
    token: BaseToken,
    unique: true,
    operators: OPERATORS_LESS_THAN_EQUAL_TO_GREATER_THAN,
  },
];
