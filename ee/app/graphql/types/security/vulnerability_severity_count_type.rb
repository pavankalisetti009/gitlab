# frozen_string_literal: true

module Types
  module Security
    # rubocop: disable Graphql/AuthorizeTypes -- to be done, this is a wip
    class VulnerabilitySeverityCountType < BaseObject
      graphql_name 'VulnerabilitySeverityCount'
      description 'Represents a count of vulnerabilities for a specific severity level'

      field :count, GraphQL::Types::Int, null: false, description: 'Number of vulnerabilities.'

      field :mean_age, GraphQL::Types::Float, null: true,
        description: 'Average age in days of vulnerabilities since detection.'
      field :median_age, GraphQL::Types::Float, null: true,
        description: 'Median age in days of vulnerabilities since detection.'
      field :severity, ::Types::VulnerabilitySeverityEnum, null: false, description: 'Severity level.'
    end
    # rubocop: enable Graphql/AuthorizeTypes
  end
end
