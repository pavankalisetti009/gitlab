# frozen_string_literal: true

module Types
  module Security
    class VulnerabilityCountFilterInputType < Types::BaseInputObject
      graphql_name 'VulnerabilityCountFilterInput'
      description 'Input type for filtering projects by vulnerability count and severity'

      argument :severity, Types::VulnerabilitySeverityEnum,
        required: true,
        description: 'Severity level of vulnerabilities to filter by.'

      argument :count, GraphQL::Types::Int,
        required: true,
        description: 'Number of vulnerabilities to filter by.',
        validates: { numericality: { greater_than_or_equal_to: 0 } }

      argument :operator, Types::Security::ComparisonOperatorEnum,
        required: true,
        description: 'Comparison operator for the vulnerability count.'
    end
  end
end
