# frozen_string_literal: true

# rubocop: disable Sidekiq/EnforceDatabaseHealthSignalDeferral -- this setting is already defined in the parent class
# rubocop: disable Scalability/IdempotentWorker -- this setting is already defined in the parent class

module Security
  module VulnerabilityScanning
    # This worker performs the same SBOM vulnerability scanning task as ProcessSbomScanWorker but with lower urgency.
    # When a project reaches the rate limit for dependency_scanning_sbom_scan_api_throttling, new SBOM scans
    # are routed to this throttled worker to manage load and prevent impact on other customers' scan processing.
    class ProcessSbomScanThrottledWorker < ProcessSbomScanWorker
      CONCURRENCY_LIMIT = 35

      urgency :low
      concurrency_limit -> { CONCURRENCY_LIMIT }
    end
  end
end

# rubocop: enable Sidekiq/EnforceDatabaseHealthSignalDeferral
# rubocop: enable Scalability/IdempotentWorker
