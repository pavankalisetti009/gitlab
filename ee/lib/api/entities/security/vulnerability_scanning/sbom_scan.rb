# frozen_string_literal: true

module API
  module Entities
    module Security
      module VulnerabilityScanning
        class SbomScan < Grape::Entity
          include ::API::Helpers::RelatedResourcesHelpers

          expose :id

          expose :download_url do |sbom_scan|
            expose_url api_v4_jobs_sbom_scans_path({ id: sbom_scan.build_id, sbom_scan_id: sbom_scan.id })
          end
        end
      end
    end
  end
end
