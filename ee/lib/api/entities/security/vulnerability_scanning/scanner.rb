# frozen_string_literal: true

module API
  module Entities
    module Security
      module VulnerabilityScanning
        class Scanner < Grape::Entity
          expose :external_id, as: :id
          expose :name
          expose :url
          expose :vendor do |scanner|
            { name: scanner.vendor }
          end
          expose :version

          private

          # url is hardcoded since it is not yet available in Gitlab::Ci::Reports::Security::Scanner
          def url
            ::Gitlab::VulnerabilityScanning::SecurityScanner::URL
          end
        end
      end
    end
  end
end
