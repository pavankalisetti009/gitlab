# frozen_string_literal: true

module API
  module Entities
    module Security
      module VulnerabilityScanning
        class Location < Grape::Entity
          expose :file_path, as: :file
          expose :dependency do |location|
            {
              package: { name: location.package_name },
              version: location.package_version
            }
          end
        end

        class Identifier < Grape::Entity
          expose :external_type, as: :type
          expose :external_id, as: :value
          expose :name
          expose :url
        end

        class Finding < Grape::Entity
          expose :name
          expose :description
          expose :severity
          expose :solution
          expose :location, using: Location
          expose :identifiers, using: Identifier
          expose :cvss, as: :cvss_vectors
          expose :links
          expose :details
        end
      end
    end
  end
end
