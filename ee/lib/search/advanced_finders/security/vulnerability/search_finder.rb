# frozen_string_literal: true

# Vulnerability::SearchFinder
#
# Used to filter Vulnerability records for Vulnerabilities API from vulnerabilities elasticsearch index
#
# Arguments:
#   see in ee/lib/search/advanced_finders/security/base_finder.rb

module Search
  module AdvancedFinders
    module Security
      module Vulnerability
        class SearchFinder < BaseFinder
          def execute
            query = ::Search::Elastic::VulnerabilityQueryBuilder.build(query: nil, options: search_params)

            options = es_search_options.merge({
              primary_key: ::Vulnerabilities::Read.primary_key.to_sym
            })

            Search::Elastic::Relation.new(::Vulnerability, query, options)
          end
        end
      end
    end
  end
end
