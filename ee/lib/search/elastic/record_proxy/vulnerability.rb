# frozen_string_literal: true

module Search
  module Elastic
    module RecordProxy
      # Vulnerability-specific record proxy that provides optimized access
      # to elasticsearch indexing data including EPSS scores, CVE values,
      # reachability, token status, policy_violations, and risk_score information.
      class Vulnerability < Base
        # Creates a vulnerability proxy with all optimizations applied
        def self.create_with_enhancements(record, enhancements)
          proxy = new(record)

          proxy.enhance_with_data({
            reachability: enhancements[:reachability],
            token_status: enhancements[:token_status],
            policy_violations: enhancements[:policy_violations],
            risk_score: enhancements[:risk_score]
          })

          proxy
        end
      end
    end
  end
end
