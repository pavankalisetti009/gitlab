# frozen_string_literal: true

module Search
  module Elastic
    module VulnerabilityIndexingHelper
      def self.vulnerability_indexing_allowed?
        @vulnerability_indexing_allowed ||= sass_with_es? || dedicated_with_es?
      end

      class << self
        private

        def sass_with_es?
          Gitlab::CurrentSettings.elasticsearch_indexing? &&
            Gitlab::Saas.feature_available?(:advanced_search)
        end

        def dedicated_with_es?
          Gitlab::CurrentSettings.elasticsearch_indexing? &&
            Gitlab::CurrentSettings.gitlab_dedicated_instance?
        end
      end
    end
  end
end
