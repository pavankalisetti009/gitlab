- return unless can?(current_user, :remove_project, @project)

- allow_immediate_namespaces_deletion = Gitlab::CurrentSettings.allow_immediate_namespaces_deletion_for_user?(current_user)

- if @project.self_deletion_scheduled? && allow_immediate_namespaces_deletion
  = render Pajamas::CardComponent.new(body_options: { class: 'gl-bg-feedback-danger' }) do |c|
    - c.with_header do
      %h4.gl-text-base.gl-leading-24.gl-m-0
        = s_('ProjectSettings|Delete project immediately')
    - c.with_body do
      %p= delete_immediately_namespace_scheduled_for_deletion_message(@project)
      #js-project-delete-button{ data: project_delete_immediately_button_data(@project, title) }
- elsif @project.scheduled_for_deletion_in_hierarchy_chain?
  = render Pajamas::CardComponent.new do |c|
    - c.with_header do
      %h4.gl-text-base.gl-leading-24.gl-m-0
        = s_('ProjectSettings|Delete project immediately')
    - c.with_body do
      -# Immediate deletion not available: either because of ancestor, or instance setting
      - help_page_link = link_to('', help_page_path('user/project/working_with_projects.md', anchor: 'delete-a-project-immediately'), target: '_blank', rel: 'noopener noreferrer')
      %p.gl-m-0
        = self_or_ancestors_deletion_in_progress_or_scheduled_message(@project)
        - if @project.self_deletion_scheduled?
          = safe_format(s_('ProjectSettings|%{link_start}How do I immediately delete a project?%{link_end}'), tag_pair(help_page_link, :link_start, :link_end))
- else
  -# Neither the project or its ancestor is scheduled for deletion
  = render Pajamas::CardComponent.new(body_options: { class: 'gl-bg-feedback-danger' }) do |c|
    - c.with_header do
      %h4.gl-text-base.gl-leading-24.gl-m-0
        = s_('ProjectSettings|Delete project')
    - c.with_body do
      = render 'delete_delayed'
